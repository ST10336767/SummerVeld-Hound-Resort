Index: app/src/main/java/com/example/summerveldhoundresort/ui/auth/LoginFragment.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.summerveldhoundresort.ui.auth\r\n\r\nimport android.app.Activity\r\nimport android.content.ContentValues.TAG\r\nimport android.content.Intent\r\nimport android.os.Bundle\r\nimport android.util.Log\r\nimport android.view.LayoutInflater\r\nimport android.view.View\r\nimport android.view.ViewGroup\r\nimport android.widget.Toast\r\nimport androidx.activity.result.contract.ActivityResultContracts\r\nimport androidx.fragment.app.Fragment\r\nimport androidx.lifecycle.ViewModelProvider\r\nimport androidx.lifecycle.lifecycleScope\r\nimport androidx.navigation.fragment.findNavController\r\nimport com.example.summerveldhoundresort.MainActivity\r\nimport com.example.summerveldhoundresort.R\r\nimport com.example.summerveldhoundresort.databinding.FragmentLoginBinding\r\nimport com.example.summerveldhoundresort.db.AppResult\r\nimport com.example.summerveldhoundresort.db.implementations.firebaseUsersImpl\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInClient\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions\r\n\r\nimport com.google.android.gms.common.api.ApiException\r\nimport com.google.android.gms.tasks.Task\r\nimport com.google.firebase.Firebase\r\nimport com.google.firebase.auth.FirebaseAuth\r\nimport com.google.firebase.auth.FirebaseUser\r\nimport com.google.firebase.auth.GoogleAuthProvider\r\nimport com.google.firebase.auth.auth\r\nimport kotlinx.coroutines.launch\r\n\r\n\r\n@Suppress(\"DEPRECATION\")\r\nclass LoginFragment : Fragment() {\r\n\r\n    private lateinit var authViewModel: AuthViewModel\r\n\r\n    private var _binding: FragmentLoginBinding? = null\r\n    private val binding get() = _binding!!\r\n\r\n    // NEW: Google Sign-In client and Firebase Auth instance\r\n    private lateinit var googleSignInClient: GoogleSignInClient\r\n    private lateinit var firebaseAuth: FirebaseAuth\r\n\r\n    // NEW: Request code for Google Sign-In\r\n    companion object {\r\n        private const val RC_GOOGLE_SIGN_IN = 9001 // Renamed to avoid confusion with ContentValues.TAG\r\n        private const val TAG = \"LoginFragment\" // Use a more specific TAG for this class\r\n    }\r\n\r\n    override fun onCreateView(\r\n        inflater: LayoutInflater, container: ViewGroup?,\r\n        savedInstanceState: Bundle?\r\n    ): View {\r\n        _binding = FragmentLoginBinding.inflate(inflater, container, false)\r\n        return binding.root // Return the root directly here\r\n    }\r\n\r\n    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\r\n        super.onViewCreated(view, savedInstanceState)\r\n\r\n        val fbUserImpl = firebaseUsersImpl()\r\n        val factory = AuthViewModelFactory{AuthViewModel(fbUserImpl)}\r\n        authViewModel = ViewModelProvider(this, factory)[AuthViewModel::class.java]\r\n\r\n        // Initialize Firebase Auth\r\n        firebaseAuth = FirebaseAuth.getInstance()\r\n        val gso = GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n            .requestIdToken(getString(R.string.default_web_client_id)) // Your server's client ID\r\n            .requestEmail()\r\n            .build()\r\n        val googleSignInClient = GoogleSignIn.getClient(requireActivity(), gso)\r\n\r\n\r\n\r\n        // Set click listener for the traditional email/password Login button\r\n        binding.buttonLogin.setOnClickListener{\r\n            val emailAddress = binding.edtEmailAddress.text.toString().trim() // Trim whitespace\r\n            val password = binding.textInputPassword.editText?.text.toString().trim() // Trim whitespace\r\n\r\n            // Basic validation (you can add more robust validation)\r\n            if (emailAddress.isEmpty() || password.isEmpty()) {\r\n                Toast.makeText(requireContext(), \"Email and password cannot be empty.\", Toast.LENGTH_SHORT).show()\r\n                return@setOnClickListener\r\n            }\r\n\r\n            lifecycleScope.launch {\r\n                val result = authViewModel.login(\r\n                    userLoginField = emailAddress,\r\n                    password = password\r\n                )\r\n                Log.d(TAG, \"Login details: $emailAddress, password: $password \")\r\n                when(result){\r\n                    is AppResult.Success -> {\r\n                        Log.d(TAG, \"SUCCESS result: $result\")\r\n                        Toast.makeText(\r\n                            requireContext(),\r\n                            \"Login Successful\",\r\n                            Toast.LENGTH_SHORT\r\n                        ).show()\r\n                        // Navigate to MainActivity after successful login\r\n                        val intent = Intent(requireContext(), MainActivity::class.java)\r\n                        startActivity(intent)\r\n                        requireActivity().finish() // Finish the activity hosting this fragment\r\n                    }\r\n\r\n                    is AppResult.Error<*> -> {\r\n                        Log.e(TAG, \"Login Failed: ${result.exception?.message}\") // Use e for errors\r\n                        Toast.makeText(requireContext(), \"Login Failed: ${result.exception?.message}\", Toast.LENGTH_LONG).show()\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        val signInLauncher =\r\n            registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->\r\n                if (result.resultCode == Activity.RESULT_OK) {\r\n                    val task = GoogleSignIn.getSignedInAccountFromIntent(result.data)\r\n                    handleSignInResult(task)\r\n                }\r\n            }\r\n        // Set click listener for the Google Sign-In button\r\n        binding.googleSignInButton.setOnClickListener {\r\n            val signInIntent = googleSignInClient.signInIntent\r\n            signInLauncher.launch(signInIntent)\r\n        }\r\n\r\n        // Set click listener for Sign Up text\r\n        binding.tvSignUp.setOnClickListener{\r\n            findNavController().navigate(R.id.action_loginFragment_to_registerFragment)\r\n        }\r\n\r\n        binding.buttonForgotPassword.setOnClickListener{\r\n            findNavController().navigate(R.id.action_loginFragment_to_forgotPassawordFragment)\r\n        }\r\n    }\r\n\r\n    private fun handleSignInResult(completedTask: Task<GoogleSignInAccount>) {\r\n        try {\r\n            val account = completedTask.getResult(ApiException::class.java)\r\n            firebaseAuthWithGoogle(account.idToken!!)\r\n        } catch (e: ApiException) {\r\n            // Handle sign-in failure\r\n            Toast.makeText(requireContext(), \"Google Sign-In failed.\", Toast.LENGTH_SHORT).show()\r\n        }\r\n    }\r\n\r\n    private fun firebaseAuthWithGoogle(idToken: String) {\r\n        val credential = GoogleAuthProvider.getCredential(idToken, null)\r\n        Firebase.auth.signInWithCredential(credential)\r\n            .addOnCompleteListener(requireActivity()) { task ->\r\n                if (task.isSuccessful) {\r\n                    // Firebase sign-in successful.\r\n                    Toast.makeText(requireContext(), \"Sign in successful\", Toast.LENGTH_SHORT).show()\r\n                    // Now, trigger the biometric authentication flow.\r\n                    val intent = Intent(requireContext(), MainActivity::class.java)\r\n                    startActivity(intent)\r\n                    requireActivity().finish()\r\n                } else {\r\n                    // Sign in failed.\r\n                    Toast.makeText(requireContext(), \"Firebase authentication failed.\", Toast.LENGTH_SHORT).show()\r\n                }\r\n            }\r\n    }\r\n\r\n\r\n    // Function to start the Google Sign-In flow\r\n    private fun signInWithGoogle() {\r\n        Log.d(TAG, \"Starting Google Sign-In flow.\")\r\n        val signInIntent = googleSignInClient.signInIntent\r\n        startActivityForResult(signInIntent, RC_GOOGLE_SIGN_IN)\r\n    }\r\n\r\n    // Handles the result from the Google Sign-In activity\r\n\r\n\r\n    override fun onDestroyView() {\r\n        super.onDestroyView()\r\n        _binding = null\r\n    }\r\n}
===================================================================
diff --git a/app/src/main/java/com/example/summerveldhoundresort/ui/auth/LoginFragment.kt b/app/src/main/java/com/example/summerveldhoundresort/ui/auth/LoginFragment.kt
--- a/app/src/main/java/com/example/summerveldhoundresort/ui/auth/LoginFragment.kt	(revision 2d54d60dbbe639d269197366642c0af8f813c9fe)
+++ b/app/src/main/java/com/example/summerveldhoundresort/ui/auth/LoginFragment.kt	(date 1755760899040)
@@ -64,7 +64,7 @@
         super.onViewCreated(view, savedInstanceState)
 
         val fbUserImpl = firebaseUsersImpl()
-        val factory = AuthViewModelFactory{AuthViewModel(fbUserImpl)}
+        val factory = AuthViewModelFactory { AuthViewModel(fbUserImpl) }
         authViewModel = ViewModelProvider(this, factory)[AuthViewModel::class.java]
 
         // Initialize Firebase Auth
@@ -76,15 +76,19 @@
         val googleSignInClient = GoogleSignIn.getClient(requireActivity(), gso)
 
 
-
         // Set click listener for the traditional email/password Login button
-        binding.buttonLogin.setOnClickListener{
+        binding.buttonLogin.setOnClickListener {
             val emailAddress = binding.edtEmailAddress.text.toString().trim() // Trim whitespace
-            val password = binding.textInputPassword.editText?.text.toString().trim() // Trim whitespace
+            val password =
+                binding.textInputPassword.editText?.text.toString().trim() // Trim whitespace
 
             // Basic validation (you can add more robust validation)
             if (emailAddress.isEmpty() || password.isEmpty()) {
-                Toast.makeText(requireContext(), "Email and password cannot be empty.", Toast.LENGTH_SHORT).show()
+                Toast.makeText(
+                    requireContext(),
+                    "Email and password cannot be empty.",
+                    Toast.LENGTH_SHORT
+                ).show()
                 return@setOnClickListener
             }
 
@@ -94,7 +98,7 @@
                     password = password
                 )
                 Log.d(TAG, "Login details: $emailAddress, password: $password ")
-                when(result){
+                when (result) {
                     is AppResult.Success -> {
                         Log.d(TAG, "SUCCESS result: $result")
                         Toast.makeText(
@@ -108,37 +112,41 @@
                         requireActivity().finish() // Finish the activity hosting this fragment
                     }
 
-                    is AppResult.Error<*> -> {
+                    is AppResult.Error -> {
                         Log.e(TAG, "Login Failed: ${result.exception?.message}") // Use e for errors
-                        Toast.makeText(requireContext(), "Login Failed: ${result.exception?.message}", Toast.LENGTH_LONG).show()
-                }
-            }
-        }
+                        Toast.makeText(
+                            requireContext(),
+                            "Login Failed: ${result.exception?.message}",
+                            Toast.LENGTH_LONG
+                        ).show()
+                    }
+                }
+            }
 
 
-        val signInLauncher =
-            registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->
-                if (result.resultCode == Activity.RESULT_OK) {
-                    val task = GoogleSignIn.getSignedInAccountFromIntent(result.data)
-                    handleSignInResult(task)
-                }
-            }
-        // Set click listener for the Google Sign-In button
-        binding.googleSignInButton.setOnClickListener {
-            val signInIntent = googleSignInClient.signInIntent
-            signInLauncher.launch(signInIntent)
-        }
+            val signInLauncher =
+                registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->
+                    if (result.resultCode == Activity.RESULT_OK) {
+                        val task = GoogleSignIn.getSignedInAccountFromIntent(result.data)
+                        handleSignInResult(task)
+                    }
+                }
+            // Set click listener for the Google Sign-In button
+            binding.googleSignInButton.setOnClickListener {
+                val signInIntent = googleSignInClient.signInIntent
+                signInLauncher.launch(signInIntent)
+            }
 
-        // Set click listener for Sign Up text
-        binding.tvSignUp.setOnClickListener{
-            findNavController().navigate(R.id.action_loginFragment_to_registerFragment)
-        }
+            // Set click listener for Sign Up text
+            binding.tvSignUp.setOnClickListener {
+                findNavController().navigate(R.id.action_loginFragment_to_registerFragment)
+            }
 
-        binding.buttonForgotPassword.setOnClickListener{
-            findNavController().navigate(R.id.action_loginFragment_to_forgotPassawordFragment)
+            binding.buttonForgotPassword.setOnClickListener {
+                findNavController().navigate(R.id.action_loginFragment_to_forgotPassawordFragment)
+            }
         }
     }
-
     private fun handleSignInResult(completedTask: Task<GoogleSignInAccount>) {
         try {
             val account = completedTask.getResult(ApiException::class.java)
Index: app/src/main/res/navigation/mobile_navigation.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<navigation xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/mobile_navigation\"\r\n    app:startDestination=\"@+id/navigation_home\">\r\n\r\n    <fragment\r\n        android:id=\"@+id/navigation_home\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.home.HomeFragment\"\r\n        android:label=\"@string/title_home\"\r\n        tools:layout=\"@layout/fragment_home\" />\r\n\r\n    <fragment\r\n        android:id=\"@+id/navigation_dashboard\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.dashboard.DashboardFragment\"\r\n        android:label=\"@string/title_dashboard\"\r\n        tools:layout=\"@layout/fragment_dashboard\" />\r\n\r\n    <fragment\r\n        android:id=\"@+id/navigation_notifications\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.notifications.NotificationsFragment\"\r\n        android:label=\"@string/title_notifications\"\r\n        tools:layout=\"@layout/fragment_notifications\" />\r\n    <fragment\r\n        android:id=\"@+id/loginFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.auth.LoginFragment\"\r\n        android:label=\"fragment_login\"\r\n        tools:layout=\"@layout/fragment_login\" >\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_registerFragment\"\r\n            app:destination=\"@id/registerFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_navigation_home\"\r\n            app:destination=\"@id/navigation_home\" />\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_forgotPassawordFragment\"\r\n            app:destination=\"@id/forgotPassawordFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/registerFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.auth.RegisterFragment\"\r\n        android:label=\"fragment_register\"\r\n        tools:layout=\"@layout/fragment_register\" >\r\n        <action\r\n            android:id=\"@+id/action_registerFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_registerFragment_to_navigation_home\"\r\n            app:destination=\"@id/navigation_home\" />\r\n    </fragment>\r\n    <fragment\r\n\r\n        android:id=\"@+id/forgotPassawordFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.auth.ForgotPassawordFragment\"\r\n        android:label=\"fragment_forgot_passaword\"\r\n        tools:layout=\"@layout/fragment_forgot_passaword\" />\r\n        android:id=\"@+id/changePasswordFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.profile.ChangePasswordFragment\"\r\n        android:label=\"fragment_change_password\"\r\n        tools:layout=\"@layout/fragment_change_password\" />\r\n    <fragment\r\n        android:id=\"@+id/editProfileFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.profile.EditProfileFragment\"\r\n        android:label=\"fragment_edit_profile\"\r\n        tools:layout=\"@layout/fragment_edit_profile\" />\r\n    <fragment\r\n        android:id=\"@+id/profileViewFragment\"\r\n        android:name=\"com.example.summerveldhoundresort.ui.profile.ProfileViewFragment\"\r\n        android:label=\"fragment_profile_view\"\r\n        tools:layout=\"@layout/fragment_profile_view\" >\r\n        <action\r\n            android:id=\"@+id/action_profileViewFragment_to_changePasswordFragment\"\r\n            app:destination=\"@id/changePasswordFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_profileViewFragment_to_editProfileFragment\"\r\n            app:destination=\"@id/editProfileFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_profileViewFragment_to_editProfileFragment2\"\r\n            app:destination=\"@id/editProfileFragment\" />\r\n    </fragment>\r\n\r\n</navigation>
===================================================================
diff --git a/app/src/main/res/navigation/mobile_navigation.xml b/app/src/main/res/navigation/mobile_navigation.xml
--- a/app/src/main/res/navigation/mobile_navigation.xml	(revision 2d54d60dbbe639d269197366642c0af8f813c9fe)
+++ b/app/src/main/res/navigation/mobile_navigation.xml	(date 1755761000170)
@@ -79,5 +79,10 @@
             android:id="@+id/action_profileViewFragment_to_editProfileFragment2"
             app:destination="@id/editProfileFragment" />
     </fragment>
+    <fragment
+        android:id="@+id/changePasswordFragment"
+        android:name="com.example.summerveldhoundresort.ui.profile.ChangePasswordFragment"
+        android:label="fragment_change_password"
+        tools:layout="@layout/fragment_change_password" />
 
 </navigation>
\ No newline at end of file
